import{a as xe}from"./chunk-M6ZYS3KI.js";import{q as fe}from"./chunk-IWJXRAUU.js";import{a as ye,b as he,i as Ce,j as _e,k as ge,l as Me,m as De,n as Fe}from"./chunk-SUADYUT2.js";import{q as ve}from"./chunk-YJ5DE537.js";import{c as oe}from"./chunk-MM4TQYZZ.js";import{a as re,b as le,c as me,d as pe,e as ce,f as se,g as de,h as ue}from"./chunk-2AC7F2HJ.js";import{a as be}from"./chunk-KPE2YWK4.js";import{b as ne,c as ae}from"./chunk-2DC7NVQR.js";import{d as L,f as c,h as G,i as R,k as U,n as K,o as Y,p as H,r as W,s as Q,t as X,u as ee,x as te,y as ie}from"./chunk-IIFEEIO4.js";import{da as A,oa as B,ua as Z,xa as J}from"./chunk-MLNSEME7.js";import{l as q}from"./chunk-JOIIREXN.js";import{$b as V,Eb as d,Gb as p,Ka as k,La as P,Lb as u,Nb as N,Ob as w,Pb as a,Qb as t,Rb as f,Vb as z,bc as h,ic as _,jc as l,kc as O,lc as $,mb as r,nb as S,pa as I,rc as j,sa as y,tc as g,uc as M,y as D,za as E}from"./chunk-WRJUXR2E.js";var v=e=>i=>{let s=new Date(e.value),n=new Date(i.value);return!s||!n?null:s>=n?{greaterThan:!0}:null};var Te=(e,i)=>i.id;function Ie(e,i){e&1&&(a(0,"mat-error"),l(1," Tytu\u0142 polisy jest wymagane "),t())}function Ee(e,i){e&1&&(a(0,"mat-error"),l(1," Numer polisy jest wymagany "),t())}function ke(e,i){if(e&1&&f(0,"app-autocomplete",19),e&2){let s=h(),n=h();p("control",n.form.controls.insuranceCompanyId)("options",s)}}function Pe(e,i){e&1&&d(0,ke,1,2,"app-autocomplete",19),e&2&&u(0,i.length?0:-1)}function Se(e,i){e&1&&(a(0,"mat-error"),l(1," Koniec nie mo\u017Ce by\u0107 przed pocz\u0105tkiem "),t())}function Ne(e,i){e&1&&(a(0,"mat-error"),l(1," Termin nie mo\u017Ce by\u0107 przed pocz\u0105tkiem "),t())}function we(e,i){if(e&1&&f(0,"app-autocomplete",20),e&2){let s=h(),n=h();p("control",n.form.controls.insurerId)("options",s)}}function ze(e,i){e&1&&d(0,we,1,2,"app-autocomplete",20),e&2&&u(0,i.length?0:-1)}function Ve(e,i){if(e&1&&(a(0,"mat-option",16),l(1),t()),e&2){let s=i.$implicit;p("value",s.id),r(),O(s.name)}}var Oe=new I("POLICY_FORM"),ht=(()=>{let i=class i{constructor(n){this.policy=n,this.fb=y(H),this.policiesFacade=y(fe),this.insuranceTypesFacade=y(xe),this.insuranceCompaniesFacade=y(be),this.insurersFacade=y(ve),this.insuranceCompanies$=this.insuranceCompaniesFacade.companies$.pipe(D(m=>m.map(o=>({id:o.id,value:o.shortName})))),this.insurers$=this.insurersFacade.insurers$.pipe(D(m=>m.map(o=>({id:o.id,value:`${o.lastName} ${o.firstName}`})))),this.insuranceTypes$=this.insuranceTypesFacade.insuranceTypes$,this.form=this.fb.group({title:this.fb.control("",[c.required,c.maxLength(60)]),policyNumber:this.fb.control("",[c.required,c.maxLength(60)]),insuranceCompanyId:this.fb.control(null,[c.required]),startDate:this.fb.control(null,[c.required]),endDate:this.fb.control(null),paymentDate:this.fb.control(null),isPaid:this.fb.nonNullable.control(!1),insurerId:this.fb.control(null,c.required),insuranceTypeIds:this.fb.nonNullable.control([])})}ngOnInit(){this.insuranceTypesFacade.getInsuranceTypes(),this.insuranceCompaniesFacade.getCompanies(),this.insurersFacade.getAllInsurers(),this.updateValidators(),this.policy&&this.form.patchValue({title:this.policy.title,policyNumber:this.policy.policyNumber,endDate:this.policy.endDate,startDate:this.policy.startDate,insuranceCompanyId:this.policy.insuranceCompany?.id,insurerId:this.policy.insurer?.id,isPaid:this.policy.isPaid,paymentDate:this.policy.paymentDate,insuranceTypeIds:this.policy.insuranceTypes?.map(n=>n.id)})}onSubmit(){let n=Fe(this.form.value);this.form.invalid||(this.policy&&this.policy.id?this.policiesFacade.editPolicy(n,this.policy.id):this.policiesFacade.createPolicy(n))}updateValidators(){let n=this.form.controls.startDate,m=this.form.controls.endDate,o=this.form.controls.paymentDate;m.setValidators([c.required,v(n)]),o.setValidators([c.required,v(n)]),m.updateValueAndValidity(),o.updateValueAndValidity()}};i.\u0275fac=function(m){return new(m||i)(S(Oe))},i.\u0275cmp=E({type:i,selectors:[["app-policies-form"]],standalone:!0,features:[j],decls:67,vars:20,consts:[["startDate",""],["endDate",""],["paymentDate",""],["novalidate","",3,"formGroup"],[1,"form-card"],[1,"card-title"],[1,"full-width"],["matInput","","formControlName","title"],[1,"row"],[1,"col"],["matInput","","formControlName","policyNumber"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["matInput","","formControlName","endDate",3,"matDatepicker"],["matInput","","formControlName","paymentDate",3,"matDatepicker"],["formControlName","insuranceTypeIds","multiple",""],[3,"value"],["formControlName","isPaid"],["mat-raised-button","","color","primary",3,"click"],["label","Towarzystwo ubezpieczeniowe","errorMessage","Towarzystwo ubezpieczeniowe jest wymagane",3,"control","options"],["label","Ubezpieczaj\u0105cy","errorMessage","Ubezpieczaj\u0105cy jest wymagany",3,"control","options"]],template:function(m,o){if(m&1){let C=z();a(0,"form",3)(1,"mat-card",4)(2,"mat-card-header")(3,"mat-card-title",5),l(4),t()(),a(5,"mat-card-content")(6,"mat-form-field",6)(7,"mat-label"),l(8,"Tytu\u0142 polisy"),t(),f(9,"input",7),d(10,Ie,2,0,"mat-error"),t(),a(11,"div",8)(12,"div",9)(13,"mat-form-field",6)(14,"mat-label"),l(15,"Numer polisy"),t(),f(16,"input",10),d(17,Ee,2,0,"mat-error"),t()(),a(18,"div",9),d(19,Pe,1,1),g(20,"async"),t()(),a(21,"div",8)(22,"div",9)(23,"mat-form-field",6)(24,"mat-label"),l(25,"Pocz\u0105tek ubezpieczenia"),t(),f(26,"input",11)(27,"mat-datepicker-toggle",12)(28,"mat-datepicker",null,0),t()(),a(30,"div",9)(31,"mat-form-field",6)(32,"mat-label"),l(33,"Koniec ubezpieczenia"),t(),f(34,"input",13)(35,"mat-datepicker-toggle",12)(36,"mat-datepicker",null,1),d(38,Se,2,0,"mat-error"),t()(),a(39,"div",9)(40,"mat-form-field",6)(41,"mat-label"),l(42,"Termin p\u0142atno\u015Bci"),t(),f(43,"input",14)(44,"mat-datepicker-toggle",12)(45,"mat-datepicker",null,2),d(47,Ne,2,0,"mat-error"),t()()(),a(48,"div",8)(49,"div",9),d(50,ze,1,1),g(51,"async"),t(),a(52,"div",9)(53,"mat-form-field",6)(54,"mat-label"),l(55,"Typy Ubezpieczenia"),t(),a(56,"mat-select",15),N(57,Ve,2,2,"mat-option",16,Te),g(59,"async"),t()()()(),a(60,"div",8)(61,"div",9)(62,"mat-checkbox",17),l(63,"Czy op\u0142acono"),t()()()(),a(64,"mat-card-actions")(65,"button",18),V("click",function(){return k(C),P(o.onSubmit())}),l(66,"Zapisz"),t()()()()}if(m&2){let C,b,x=_(29),F=_(37),T=_(46);p("formGroup",o.form),r(4),$(" ",o.policy!=null&&o.policy.id?"Edytuj polis\u0119":"Dodaj now\u0105 polis\u0119"," "),r(6),u(10,o.form.controls.title.hasError("required")?10:-1),r(7),u(17,o.form.controls.policyNumber.hasError("required")?17:-1),r(2),u(19,(C=M(20,14,o.insuranceCompanies$))?19:-1,C),r(7),p("matDatepicker",x),r(),p("for",x),r(7),p("matDatepicker",F),r(),p("for",F),r(3),u(38,o.form.controls.endDate.hasError("greaterThan")?38:-1),r(5),p("matDatepicker",T),r(),p("for",T),r(3),u(47,o.form.controls.paymentDate.hasError("greaterThan")?47:-1),r(3),u(50,(b=M(51,16,o.insurers$))?50:-1,b),r(7),w(M(59,18,o.insuranceTypes$))}},dependencies:[W,U,L,G,R,K,Y,se,re,pe,me,ce,le,ie,te,Q,X,ee,ae,ne,J,Z,oe,B,q,De,A,Me,Ce,_e,ge,ue,de,he,ye],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.form-card[_ngcontent-%COMP%]{margin:15px}.mat-radio-button[_ngcontent-%COMP%]{display:block;margin:5px 0}@media (min-width: 800px){.row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.col[_ngcontent-%COMP%]{flex:1;margin-right:20px}.col[_ngcontent-%COMP%]:last-child{margin-right:0}}.card-title[_ngcontent-%COMP%]{padding-bottom:15px}"]});let e=i;return e})();export{Oe as a,ht as b};
