import{a as fe,b as he}from"./chunk-UDNVML3Z.js";import{a as He,b as qe}from"./chunk-2MXC3VPV.js";import{a as Ae}from"./chunk-M6ZYS3KI.js";import"./chunk-YI64LF7D.js";import{a as $e,b as Fe,c as ze,d as Re,e as Oe,f as je}from"./chunk-4I4BPUBG.js";import{q as Ve}from"./chunk-IWJXRAUU.js";import{c as $,d as V,e as Be,f as F,g as Ne,h as Qe}from"./chunk-SUADYUT2.js";import"./chunk-YJ5DE537.js";import"./chunk-MM4TQYZZ.js";import{g as Ce,h as ye,i as k,j as xe,k as Pe,l as ge,m as Te,n as Se,o as we,p as be,q as Me,r as Ie,s as ve,t as De}from"./chunk-2AC7F2HJ.js";import{a as ce}from"./chunk-DE727M4T.js";import"./chunk-KPE2YWK4.js";import"./chunk-V7IF3NOS.js";import{a as Le}from"./chunk-SL2S6R6I.js";import{c as me}from"./chunk-NFT5YCZS.js";import{b as ue,c as _e}from"./chunk-2DC7NVQR.js";import{a as Ee,b as ke}from"./chunk-2TEN6ZUP.js";import"./chunk-Z65746U3.js";import{a as ne,b as oe,s as se,x as pe,y as de}from"./chunk-IIFEEIO4.js";import{ua as ae,wa as le,xa as re,y as ie,ya as z}from"./chunk-MLNSEME7.js";import{l as Z,n as ee,o as te}from"./chunk-JOIIREXN.js";import{$b as y,Eb as s,G as j,Gb as C,H as B,Ka as _,L as N,La as f,Lb as H,Mb as q,N as Q,Nb as U,Ob as K,Pb as n,Qa as I,Qb as a,Rb as T,S as L,Sb as p,Tb as d,Vb as x,bc as h,fa as M,fc as v,gc as D,hc as E,ic as W,jc as l,kc as w,l as R,lc as b,m as O,mb as m,mc as Y,qc as G,rc as J,sa as S,sc as X,tc as P,uc as g,za as A}from"./chunk-WRJUXR2E.js";var Ye=(e,t,i)=>{if(i==0||t==0)return`0 z ${i}`;i=Math.max(i,0);let o=e*t,r=o<i?Math.min(o+t,i):o+t;return`${o+1} - ${r} z ${i}`};function Ue(){let e=new $;return e.itemsPerPageLabel="Pozycji na stron\u0119:",e.nextPageLabel="Nast\u0119pna strona",e.previousPageLabel="Poprzednia strona",e.getRangeLabel=Ye,e}var Ge=()=>[5,10,15,30];function Je(e,t){if(e&1){let i=x();n(0,"mat-chip-option",30),y("click",function(){let r=_(i).$implicit,c=h();return f(c.selectInsuranceTypeId(r.id))}),l(1),a()}if(e&2){let i=t.$implicit;m(),w(i.name)}}function Xe(e,t){if(e&1){let i=x();n(0,"th",31)(1,"mat-checkbox",32),y("change",function(r){_(i);let c=h();return f(r?c.toggleAllRows():null)}),a()()}if(e&2){let i=h();m(),C("checked",i.selection.hasValue()&&i.isAllSelected())("indeterminate",i.selection.hasValue()&&!i.isAllSelected())}}function Ze(e,t){if(e&1){let i=x();n(0,"td",33)(1,"mat-checkbox",34),y("click",function(r){return _(i),f(r.stopPropagation())})("change",function(r){let c=_(i).$implicit,u=h();return f(r?u.selection.toggle(c):null)}),a()()}if(e&2){let i=t.$implicit,o=h();m(),C("checked",o.selection.isSelected(i))}}function et(e,t){e&1&&T(0,"th",35)}function tt(e,t){if(e&1){let i=x();n(0,"td",36)(1,"button",37),y("click",function(){let r=_(i).$implicit,c=h();return f(c.openDetails(r))}),n(2,"mat-icon",38),l(3,"open_in_new"),a()()()}}function it(e,t){e&1&&T(0,"th",35)}function nt(e,t){if(e&1){let i=x();n(0,"td",36)(1,"button",39),y("click",function(){let r=_(i).$implicit,c=h();return f(c.openForm(r))}),n(2,"mat-icon",38),l(3,"edit"),a()()()}}function ot(e,t){e&1&&T(0,"th",35)}function at(e,t){if(e&1){let i=x();n(0,"td",36)(1,"button",40),y("click",function(){let r=_(i).$implicit,c=h();return f(c.onDeletePolicy(r))}),n(2,"mat-icon",38),l(3,"delete"),a()()()}}function lt(e,t){e&1&&(n(0,"th",41),l(1,"Tytu\u0142"),a())}function rt(e,t){if(e&1&&(n(0,"td",33)(1,"span",42),l(2),n(3,"mat-icon",43),l(4," assignment "),a()()()),e&2){let i=t.$implicit;m(),C("cdkCopyToClipboard",i.title),m(),b(" ",i.title," ")}}function ct(e,t){e&1&&(n(0,"th",41),l(1,"Numer polisy"),a())}function mt(e,t){if(e&1&&(n(0,"td",33)(1,"div",44)(2,"span",42),l(3),n(4,"mat-icon",43),l(5," assignment "),a()()()()),e&2){let i=t.$implicit;m(2),C("cdkCopyToClipboard",i.policyNumber),m(),b(" ",i.policyNumber," ")}}function st(e,t){e&1&&(n(0,"th",31),l(1,"Ubezpieczaj\u0105cy"),a())}function pt(e,t){if(e&1&&(n(0,"td",33),l(1),a()),e&2){let i=t.$implicit;m(),Y(" ",i.insurer.lastName," ",i.insurer.firstName," ")}}function dt(e,t){e&1&&(n(0,"th",31),l(1,"Towarzystwo"),a())}function ut(e,t){if(e&1&&(n(0,"td",33),l(1),a()),e&2){let i=t.$implicit;m(),b(" ",(i.insuranceCompany==null?null:i.insuranceCompany.shortName)||i.insuranceCompany.name," ")}}function _t(e,t){e&1&&(n(0,"th",41),l(1,"Pocz\u0105tek ubezpieczenia"),a())}function ft(e,t){if(e&1&&(n(0,"td",33),l(1),P(2,"date"),a()),e&2){let i=t.$implicit;m(),w(g(2,1,i.startDate))}}function ht(e,t){e&1&&(n(0,"th",41),l(1,"Koniec ubezpieczenia"),a())}function Ct(e,t){if(e&1&&(n(0,"td",33),l(1),P(2,"date"),a()),e&2){let i=t.$implicit;m(),w(g(2,1,i.endDate))}}function yt(e,t){e&1&&(n(0,"th",41),l(1,"Termin zap\u0142aty"),a())}function xt(e,t){if(e&1&&(n(0,"td",33),l(1),P(2,"date"),a()),e&2){let i=t.$implicit;m(),w(g(2,1,i.paymentDate))}}function Pt(e,t){e&1&&(n(0,"th",41),l(1,"Typ ubezpieczenia"),a())}function gt(e,t){if(e&1&&(n(0,"td",33),l(1),P(2,"insuranceType"),a()),e&2){let i=t.$implicit;m(),w(g(2,1,i.insuranceTypes))}}function Tt(e,t){e&1&&(n(0,"th",31),l(1,"Czy op\u0142acono"),a())}function St(e,t){e&1&&(n(0,"button",45),l(1,"TAK"),a())}function wt(e,t){e&1&&(n(0,"button",46),l(1,"NIE"),a())}function bt(e,t){if(e&1&&(n(0,"td",33),s(1,St,2,0,"button",45)(2,wt,2,0),a()),e&2){let i=t.$implicit;m(),H(1,i.isPaid?1:2)}}function Mt(e,t){e&1&&T(0,"tr",47)}function It(e,t){e&1&&T(0,"tr",48)}function vt(e,t){if(e&1&&(n(0,"tr",49)(1,"td",50),l(2),a()()),e&2){h();let i=W(5);m(2),b('Brak wynik\xF3w dla: "',i.value,'"')}}var Ci=(()=>{let t=class t{constructor(){this.policiesFacade=S(Ve),this.insuranceTypesFacade=S(Ae),this.portalService=S(ce),this.injector=S(I),this.dialog=S(me),this.onDestroy$=new R,this.policies$=this.policiesFacade.policies$,this.totalItemsCount$=this.policiesFacade.totalItemsCount$,this.insuranceTypes$=this.insuranceTypesFacade.insuranceTypes$,this.searchQuery$=new O(""),this.selection=new ie(!0,[]),this.selectedInsuranceTypeId=null,this.visiblePolicies=[],this.displayedColumns=["select","details","edit","delete","title","policyNumber","insurer","insuranceCompany","startDate","endDate","paymentDate","insuranceTypes","isPaid"]}ngAfterViewInit(){this.policies$.pipe(M(this.onDestroy$)).subscribe(o=>this.visiblePolicies=o),this.searchQuery$.pipe(N(300),L(),M(this.onDestroy$)).subscribe(()=>{this.paginator.pageIndex=0,this.loadPolicies()}),j(this.sort.sortChange,this.paginator.page).pipe(M(this.onDestroy$)).subscribe(()=>this.loadPolicies()),this.insuranceTypesFacade.getInsuranceTypes()}applyFilter(o){let r=o.target.value;this.searchQuery$.next(r)}openDetails(o){this.portalService.setSelectedPortal(new z(je,null,I.create({parent:this.injector,providers:[{provide:Oe,useValue:o}]}))),this.portalService.setIsOpen(!0)}openForm(o){this.portalService.setSelectedPortal(new z(qe,null,I.create({parent:this.injector,providers:[{provide:He,useValue:o}]}))),this.portalService.setIsOpen(!0)}onDeletePolicy(o){this.dialog.open(Le,{data:{name:`${o.title}`,withMessage:!1},width:"500px"}).afterClosed().pipe(B(c=>c),Q(1)).subscribe(()=>this.policiesFacade.deletePolicy(o.id))}isAllSelected(){let o=this.selection.selected.length,r=this.visiblePolicies.length;return o===r}toggleAllRows(){if(this.isAllSelected()){this.selection.clear();return}this.selection.select(...this.visiblePolicies)}selectInsuranceTypeId(o){this.selectedInsuranceTypeId===o?this.selectedInsuranceTypeId=null:this.selectedInsuranceTypeId=o,this.loadPolicies()}loadPolicies(){let o={searchPhrase:this.searchQuery$.getValue(),pageIndex:this.paginator.pageIndex,pageSize:this.paginator.pageSize,sortBy:this.sort.active?this.sort.active.toLowerCase():"",sortDirection:this.sort.direction?this.sort.direction:"none"};this.selectedInsuranceTypeId&&(o.typeId=this.selectedInsuranceTypeId),this.policiesFacade.getPolicies(o)}};t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=A({type:t,selectors:[["app-policies"]],viewQuery:function(r,c){if(r&1&&(v(V,5),v(F,5),v(k,5)),r&2){let u;D(u=E())&&(c.paginator=u.first),D(u=E())&&(c.sort=u.first),D(u=E())&&(c.table=u.first)}},standalone:!0,features:[G([{provide:$,useValue:Ue()}]),J],decls:64,vars:14,consts:[["input",""],["paginator",""],[1,"top-container"],["matInput","",3,"keyup"],[1,"chips"],["mat-raised-button","","color","primary","matTooltip","Dodaj",3,"click"],[1,"table-responsive","mat-elevation-z8"],["mat-table","","matSort","","aria-label","Polisy",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","details"],["class","icon","mat-header-cell","",4,"matHeaderCellDef"],["class","icon","mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["matColumnDef","delete"],["matColumnDef","title"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","policyNumber"],["matColumnDef","insurer"],["matColumnDef","insuranceCompany"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","paymentDate"],["matColumnDef","insuranceTypes"],["matColumnDef","isPaid"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Wybierz stron\u0119",3,"length","pageIndex","pageSize","pageSizeOptions"],[3,"click"],["mat-header-cell",""],[3,"change","checked","indeterminate"],["mat-cell",""],[3,"click","change","checked"],["mat-header-cell","",1,"icon"],["mat-cell","",1,"icon"],["mat-icon-button","","matTooltip","Szczeg\xF3\u0142y",3,"click"],[1,"mat-18"],["mat-icon-button","","matTooltip","Edytuj",3,"click"],["mat-icon-button","","color","warn","matTooltip","Usu\u0144",3,"click"],["mat-header-cell","","mat-sort-header",""],[1,"cell-content",3,"cdkCopyToClipboard"],["matTooltip","Kopiuj"],[1,"cell"],["mat-flat-button","","color","warn","disabled",""],["mat-flat-button","","color","warn"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(r,c){if(r&1){let u=x();n(0,"div",2)(1,"mat-form-field")(2,"mat-label"),l(3,"Wyszukaj"),a(),n(4,"input",3,0),y("keyup",function(We){return _(u),f(c.applyFilter(We))}),a()(),n(6,"div",4)(7,"mat-chip-listbox"),U(8,Je,2,1,"mat-chip-option",null,q),P(10,"async"),a()(),n(11,"div")(12,"button",5),y("click",function(){return _(u),f(c.openForm())}),n(13,"mat-icon"),l(14,"add"),a(),l(15," Dodaj "),a()()(),n(16,"div",6)(17,"table",7),P(18,"async"),p(19,8),s(20,Xe,2,2,"th",9)(21,Ze,2,1,"td",10),d(),p(22,11),s(23,et,1,0,"th",12)(24,tt,4,0,"td",13),d(),p(25,14),s(26,it,1,0,"th",12)(27,nt,4,0,"td",13),d(),p(28,15),s(29,ot,1,0,"th",12)(30,at,4,0,"td",13),d(),p(31,16),s(32,lt,2,0,"th",17)(33,rt,5,2,"td",10),d(),p(34,18),s(35,ct,2,0,"th",17)(36,mt,6,2,"td",10),d(),p(37,19),s(38,st,2,0,"th",9)(39,pt,2,2,"td",10),d(),p(40,20),s(41,dt,2,0,"th",9)(42,ut,2,1,"td",10),d(),p(43,21),s(44,_t,2,0,"th",17)(45,ft,3,3,"td",10),d(),p(46,22),s(47,ht,2,0,"th",17)(48,Ct,3,3,"td",10),d(),p(49,23),s(50,yt,2,0,"th",17)(51,xt,3,3,"td",10),d(),p(52,24),s(53,Pt,2,0,"th",17)(54,gt,3,3,"td",10),d(),p(55,25),s(56,Tt,2,0,"th",9)(57,bt,3,1,"td",10),d(),s(58,Mt,1,0,"tr",26)(59,It,1,0,"tr",27)(60,vt,3,1,"tr",28),a()(),T(61,"mat-paginator",29,1),P(63,"async")}r&2&&(m(8),K(g(10,7,c.insuranceTypes$)),m(9),C("dataSource",g(18,9,c.policies$)),m(41),C("matHeaderRowDef",c.displayedColumns),m(),C("matRowDefColumns",c.displayedColumns),m(2),C("length",g(63,11,c.totalItemsCount$))("pageIndex",0)("pageSize",10)("pageSizeOptions",X(13,Ge)))},dependencies:[te,Z,ee,de,pe,se,_e,ue,De,k,Pe,we,ge,xe,be,Te,Se,Me,Ie,ve,re,ae,le,oe,ne,Be,V,Qe,F,Ne,ke,Ee,ye,Ce,Re,ze,Fe,$e,he,fe],styles:[".top-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-right:20px;flex-wrap:wrap}.full-width-table[_ngcontent-%COMP%]{width:100%}tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f0f0f0!important}@media (max-width: 800px){.top-container[_ngcontent-%COMP%]{padding-right:5px;padding-left:5px}.chips[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center;padding-bottom:10px;order:2}}.cell-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2px}.cell-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer;width:17px;height:17px;font-size:17px;opacity:0;transition:.2s}.cell-content[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{opacity:.38}"]});let e=t;return e})();export{Ci as PoliciesComponent};
